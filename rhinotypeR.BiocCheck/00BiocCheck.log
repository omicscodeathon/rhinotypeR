Checking for deprecated package usage... OK
Checking for remote package usage... OK
Checking for 'LazyData: true' usage... OK
Checking version number... OK
Checking version number validity...
y of x.y.z version should be even in release
Checking R version dependency... OK
Checking package size... OK
Checking individual file sizes... OK
Checking biocViews... OK
Checking that biocViews are present... OK
Checking package type based on biocViews... OK
Checking for non-trivial biocViews... OK
Checking that biocViews come from the same category... OK
Checking biocViews validity... OK
Checking for recommended biocViews...
Consider adding these automatically suggested biocViews: Alignment, DataImport
Checking build system compatibility... OK
Checking for proper Description: field... OK
Checking if DESCRIPTION is well formatted... OK
Checking for whitespace in DESCRIPTION field names... OK
Checking that Package field matches directory/tarball name... OK
Checking for Version: field... OK
Checking for valid maintainer... OK
Checking License: for restrictive use... OK
Checking for recommended DESCRIPTION fields... OK
Checking for Bioconductor software dependencies... OK
Checking for pinned package versions in DESCRIPTION... OK
Checking for 'fnd' role in Authors@R...
No 'fnd' role found in Authors@R. If the work is supported
        by a grant, consider adding the 'fnd' role to the list of authors.
Checking .Rbuildignore... OK
Checking for stray BiocCheck output folders... OK
Checking for inst/doc folders... OK
Checking vignette directory... OK
Checking package installation calls in R code... OK
Checking for library/require of rhinotypeR... OK
Checking coding practice... OK
Checking parsed R code in R directory, examples, vignettes... OK
Checking function lengths...
The recommended function length is 50 lines or less. There are 4 functions greater than 50 lines.
The longest 5 functions are:
plot_window() (R/00_visualizationHelpers.R): 96 lines
compute_cache() (R/00_visualizationHelpers.R): 78 lines
assignTypes() (R/06_assignTypes.R): 75 lines
plotFrequency() (R/08_plotFrequency.R): 73 lines
Checking man page documentation... OK
Checking package NEWS... OK
Checking unit tests... OK
Checking skip_on_bioc() in tests... OK
Checking formatting of DESCRIPTION, NAMESPACE, man pages, R source, and vignette source...
Consider shorter lines; 124 lines (6%) are > 80 characters long.
First few lines:
R/00_alignmentHelper.R#L16 #' @return A [Biostrings::DNAStringSet-c ...
R/00_alignmentHelper.R#L19 #'   [pairwiseDistances()] for distance  ...
R/00_alignmentHelper.R#L46   M <- matrix(strsplit(paste0(s, collaps ...
R/00_alignmentHelper.R#L49   trimmed <- Biostrings::DNAStringSet(ap ...
R/00_visualizationHelpers.R#L43 compareAndColorSequences <- function(seq ...
R/00_visualizationHelpers.R#L44   # Enhanced function to compare sequenc ...
R/00_visualizationHelpers.R#L72 #' @param aln_set \code{Biostrings::DNAS ...
R/00_visualizationHelpers.R#L74 #' @param ref_name Optional character; t ...
R/00_visualizationHelpers.R#L77 #'   Used to render mismatches. For symb ...
R/00_visualizationHelpers.R#L86 #'     \item \code{diffs_list} (list of  ...
R/00_visualizationHelpers.R#L87 #'     \item \code{col_levels} (characte ...
R/00_visualizationHelpers.R#L104     stop("SNPeek/plotAA expects an align ...
R/00_visualizationHelpers.R#L109     stop("All sequences must be the same ...
R/00_visualizationHelpers.R#L116   ref_idx <- if (is.null(ref_name)) leng ...
R/00_visualizationHelpers.R#L118                            ". Using the  ...
R/00_visualizationHelpers.R#L225 #' @param center Integer center position ...
R/00_visualizationHelpers.R#L230 #' @param highlight_bg Background color  ...
R/00_visualizationHelpers.R#L236 #' @param show_only_highlighted Logical; ...
R/00_visualizationHelpers.R#L289     warning("'show_only_highlighted = TR ...
R/00_visualizationHelpers.R#L302   axis(2, at = seq_along(cache$seq_names ...
R/01_getPrototypeSeqs.R#L29 #' specified directory. If you are follo ...
R/01_getPrototypeSeqs.R#L45 #'   # aln <- alignToRefs(query_fasta =  ...
R/02_alignToRefs.R#L15 #' @param trimToRef \code{logical(1)}. I ...
R/02_alignToRefs.R#L50 #' @return A \code{Biostrings::DNAString ...
R/02_alignToRefs.R#L97   # Optionally trim to reference non-gap ...
R/03_SNPeek.R#L55 #' fasta_file <- system.file("extdata",  ...
R/03_SNPeek.R#L74                    colorMapNT = c(A = "g ...
R/03_SNPeek.R#L77                    highlight_bg = grDevi ...
R/04_countSNPs.R#L6 #' Proportions are computed with [MSA2di ...
R/04_countSNPs.R#L11 #' @param deleteGapsGlobally Logical. If ...
R/05_pairwiseDistances.R#L9 #'   DNA sequences. Sequences must all b ...
R/05_pairwiseDistances.R#L15 #'   one gap (`-`) are removed prior to  ...
R/05_pairwiseDistances.R#L16 #'   If `FALSE` (default), gaps are hand ...
R/06_assignTypes.R#L7 #' threshold, the sequence is returned a ...
R/06_assignTypes.R#L16 #'           sequences jointly with the  ...
R/06_assignTypes.R#L25 #'   are removed across all sequences be ...
R/06_assignTypes.R#L43 #'   \item{distance}{Nearest pairwise di ...
R/06_assignTypes.R#L44 #'   \item{reference}{Prototype accessio ...
R/06_assignTypes.R#L68 #'   # use getPrototypeSeqs() to downloa ...
R/06_assignTypes.R#L70 #'     res <- assignTypes(fastaD, model  ...
R/06_assignTypes.R#L93       "To classify rhinovirus sequences, ...
R/06_assignTypes.R#L96       "alignToRefs(seqData = fastaData,  ...
R/06_assignTypes.R#L97       "  (2) Export prototypes with getP ...
R/06_assignTypes.R#L111   distances <- distances[!rownames(dista ...
R/07_overallMeanDistance.R#L4 #' in an alignment. Optionally deletes c ...
R/07_overallMeanDistance.R#L7 #' @param fastaData A \link[Biostrings]{ ...
R/07_overallMeanDistance.R#L9 #'   Defaults to `"IUPAC"`. Other option ...
R/07_overallMeanDistance.R#L10 #' @param deleteGapsGlobally Logical; if ...
R/07_overallMeanDistance.R#L12 #' @param ... Additional arguments passe ...
R/07_overallMeanDistance.R#L36 overallMeanDistance <- function(fastaDat ...
R/08_plotFrequency.R#L4 #' Optionally displays a legend indicati ...
R/08_plotFrequency.R#L6 #' @param assignedTypesDF A data frame,  ...
R/08_plotFrequency.R#L10 #' @param sort Logical; if \code{TRUE},  ...
R/08_plotFrequency.R#L11 #' @param las Integer; axis label style  ...
R/08_plotFrequency.R#L55     stop("assignedTypesDF is missing req ...
R/08_plotFrequency.R#L63   types_counts <- as.data.frame(table(as ...
R/08_plotFrequency.R#L67   # strip common prefixes (RV-, RV_, RV) ...
R/08_plotFrequency.R#L79   types_counts$species <- vapply(types_c ...
R/10_plotTree.R#L44   if (!isTRUE(all.equal(distance_matrix, ...
R/11_plotAA.R#L1 #' Visualize amino acid differences agai ...
R/11_plotAA.R#L95                      R = "red2", H = "re ...
R/11_plotAA.R#L96                      D = "blue2", E = "b ...
R/11_plotAA.R#L97                      S = "green3", T = " ...
R/11_plotAA.R#L99                      F = "gold", W = "go ...
R/11_plotAA.R#L103                    highlight_bg = grDevi ...
R/11_plotAA.R#L113     aln_set       = aln_aa_set,        # ...
R/rhinotypeR.R#L11 #'         based on distances to prototy ...
R/rhinotypeR.R#L13 #'   \item \code{\link{pairwiseDistances ...
R/rhinotypeR.R#L14 #'         between all sequences using s ...
R/rhinotypeR.R#L21 #'   \item \code{\link{alignToRefs}}: Al ...
R/rhinotypeR.R#L27 #'         (removes any column containin ...
R/rhinotypeR.R#L32 #'   \item \code{\link{plotDistances}}:  ...
R/rhinotypeR.R#L33 #'   \item \code{\link{plotTree}}: Gener ...
R/rhinotypeR.R#L34 #'   \item \code{\link{SNPeek}}: Visuali ...
R/rhinotypeR.R#L36 #'   \item \code{\link{plotAA}}: Display ...
R/rhinotypeR.R#L38 #'   % \item \code{\link{plotFrequency}} ...
R/rhinotypeR.R#L43 #'   \item \emph{Format:} FASTA; DNA for ...
R/rhinotypeR.R#L45 #'   \item \emph{Length/QC:} Recommended ...
R/rhinotypeR.R#L46 #'   \item \emph{Alignment:} Required be ...
R/rhinotypeR.R#L47 #'         \code{\link{alignToRefs}} or  ...
R/rhinotypeR.R#L55 #'   \item Align externally (e.g., MAFFT ...
R/rhinotypeR.R#L56 #'   \item Import alignment: \code{Biost ...
R/rhinotypeR.R#L85 #'   \item \strong{threshold:} Default 0 ...
R/rhinotypeR.R#L87 #'   \item \strong{trimToRef:} When TRUE ...
R/rhinotypeR.R#L89 #'   \item \strong{deleteGapsGlobally:}  ...
R/rhinotypeR.R#L90 #'   \item \strong{model:} Evolutionary  ...
R/rhinotypeR.R#L96 #'         \code{Biostrings::DNAStringSe ...
R/rhinotypeR.R#L97 #'         Reported by McIntyre et al. ( ...
R/rhinotypeR.R#L101 #'         Luka et al. (2020), \emph{Ope ...
R/rhinotypeR.R#L106 #' The default genotype cutoff in \code{ ...
R/rhinotypeR.R#L107 #' (~10.5\%), consistent with commonly u ...
R/rhinotypeR.R#L137 #'   \item \strong{Misaligned regions:}  ...
R/rhinotypeR.R#L139 #'   \item \strong{Gap issues:} Consider ...
R/rhinotypeR.R#L146 #' \code{\link{alignToRefs}}, \code{\lin ...
R/rhinovirusPrototypesVP4.R#L12 #' These sequences mirror the prototypes ...
R/rhinovirusPrototypesVP4.R#L13 #' You may use this object directly in w ...
R/rhinovirusVP4.R#L31 #' Adema, I. et al. (2020).Surveillance  ...
vignettes/rhinotypeR.Rmd#L24 The `rhinotypeR` package is designed to  ...
vignettes/rhinotypeR.Rmd#L30 - Visualization (`plotFrequency()`, `plo ...
vignettes/rhinotypeR.Rmd#L31 - Data helpers (`alignToRefs()` for opti ...
vignettes/rhinotypeR.Rmd#L36 **A. Align externally** (Your tool of ch ...
vignettes/rhinotypeR.Rmd#L38 **B. Align in R** (with packaged prototy ...
vignettes/rhinotypeR.Rmd#L40 **Tip:** Genotype assignment relies on d ...
vignettes/rhinotypeR.Rmd#L67 - **Length/QC:** We recommend ≥350 bp (t ...
vignettes/rhinotypeR.Rmd#L68 - **Alignment:** Required before genotyp ...
vignettes/rhinotypeR.Rmd#L72 Prefer your own alignment tool? Use `get ...
vignettes/rhinotypeR.Rmd#L80 # 2) Combine RVRefs.fasta with your new  ...
vignettes/rhinotypeR.Rmd#L81 # 3) Manually curate (trim to VP4/2 span ...
vignettes/rhinotypeR.Rmd#L94 Use this when you want a fully scripted  ...
vignettes/rhinotypeR.Rmd#L112 - `trimToRef = TRUE` crops the alignment ...
vignettes/rhinotypeR.Rmd#L113 - `deleteGapsGlobally()` performs global ...
vignettes/rhinotypeR.Rmd#L119 res <- assignTypes(aln_curated, model =  ...
vignettes/rhinotypeR.Rmd#L125 res <- assignTypes(aln, model = "IUPAC", ...
vignettes/rhinotypeR.Rmd#L138 **Thresholds:** We default to `threshold ...
vignettes/rhinotypeR.Rmd#L153   deleteGapsGlobally = FALSE   # set TRU ...
vignettes/rhinotypeR.Rmd#L181 The `SNPeek()` function visualizes singl ...
vignettes/rhinotypeR.Rmd#L188 `SNPeek()` (nucleotide) and `plotAA()` ( ...
vignettes/rhinotypeR.Rmd#L197 aa_seq <- Biostrings::readAAStringSet(sy ...
vignettes/rhinotypeR.Rmd#L214 **Tip:** `show_only_highlighted = TRUE`  ...
vignettes/rhinotypeR.Rmd#L218 * **Prototypes missing?** `assignTypes() ...
vignettes/rhinotypeR.Rmd#L219 * **Misaligned region?** Use `trimToRef  ...
vignettes/rhinotypeR.Rmd#L220 * **Gaps distort distances?** Consider ` ...
vignettes/rhinotypeR.Rmd#L221 * **SNP/AA plots truncated?** Increase d ...
vignettes/rhinotypeR.Rmd#L225 The `rhinotypeR` package simplifies the  ...
Consider multiples of 4 spaces for line indents; 455 lines (24%) are not.
First few lines:
R/00_alignmentHelper.R#L35   if (!inherits(aln, "DNAStringSet")) { ...
R/00_alignmentHelper.R#L37   } ...
R/00_alignmentHelper.R#L38   w <- Biostrings::width(aln) ...
R/00_alignmentHelper.R#L39   if (length(unique(w)) != 1L) { ...
R/00_alignmentHelper.R#L41   } ...
R/00_alignmentHelper.R#L42    ...
R/00_alignmentHelper.R#L43   gap_chars <- c("-", ".") # some aligne ...
R/00_alignmentHelper.R#L44   s <- as.character(aln) ...
R/00_alignmentHelper.R#L45   L <- w[1] ...
R/00_alignmentHelper.R#L46   M <- matrix(strsplit(paste0(s, collaps ...
R/00_alignmentHelper.R#L47   stopifnot(ncol(M) == L) ...
R/00_alignmentHelper.R#L48   keep_cols <- apply(M, 2, function(col) ...
R/00_alignmentHelper.R#L49   trimmed <- Biostrings::DNAStringSet(ap ...
R/00_alignmentHelper.R#L50   names(trimmed) <- names(aln) ...
R/00_alignmentHelper.R#L51   trimmed ...
R/00_alignmentHelper.R#L52    ...
R/00_visualizationHelpers.R#L44   # Enhanced function to compare sequenc ...
R/00_visualizationHelpers.R#L45   compareSequences <- function(seqA, seq ...
R/00_visualizationHelpers.R#L51   } ...
R/00_visualizationHelpers.R#L52    ...
R/00_visualizationHelpers.R#L53   # Compare sequences and assign colors ...
R/00_visualizationHelpers.R#L54   diffList <- lapply(2:length(sequences) ...
R/00_visualizationHelpers.R#L59   }) ...
R/00_visualizationHelpers.R#L60    ...
R/00_visualizationHelpers.R#L61   return(diffList) ...
R/00_visualizationHelpers.R#L100                           ref_name = NUL ...
R/00_visualizationHelpers.R#L101                           colorMap, ...
R/00_visualizationHelpers.R#L102                           colorFallback  ...
R/00_visualizationHelpers.R#L103   if (!inherits(aln_set, c("DNAStringSet ...
R/00_visualizationHelpers.R#L105   } ...
R/00_visualizationHelpers.R#L106    ...
R/00_visualizationHelpers.R#L107   w <- Biostrings::width(aln_set) ...
R/00_visualizationHelpers.R#L108   if (length(unique(w)) != 1L) { ...
R/00_visualizationHelpers.R#L110   } ...
R/00_visualizationHelpers.R#L111    ...
R/00_visualizationHelpers.R#L112   seq_names <- names(aln_set) ...
R/00_visualizationHelpers.R#L113   genome_len <- w[1] ...
R/00_visualizationHelpers.R#L114    ...
R/00_visualizationHelpers.R#L115   # Choose reference (default last) ...
R/00_visualizationHelpers.R#L116   ref_idx <- if (is.null(ref_name)) leng ...
R/00_visualizationHelpers.R#L117   if (is.na(ref_idx)) stop("Reference na ...
R/00_visualizationHelpers.R#L118                            ". Using the  ...
R/00_visualizationHelpers.R#L119   ref_label <- seq_names[ref_idx] ...
R/00_visualizationHelpers.R#L120    ...
R/00_visualizationHelpers.R#L121   # Reorder so REFERENCE is LAST (stable ...
R/00_visualizationHelpers.R#L122   ord_idx <- c(setdiff(seq_along(aln_set ...
R/00_visualizationHelpers.R#L123   aln_ord <- aln_set[ord_idx] ...
R/00_visualizationHelpers.R#L124   names_ord <- names(aln_ord) ...
R/00_visualizationHelpers.R#L125   ref_row <- length(aln_ord) ...
R/00_visualizationHelpers.R#L126    ...
R/00_visualizationHelpers.R#L127   # Character matrix (rows = seqs, cols  ...
R/00_visualizationHelpers.R#L128   M <- as.matrix(aln_ord) ...
R/00_visualizationHelpers.R#L129    ...
R/00_visualizationHelpers.R#L130   # Build color index mapping for speed/ ...
R/00_visualizationHelpers.R#L131   nts <- c(names(colorMap)) ...
R/00_visualizationHelpers.R#L132   pal <- unname(colorMap) ...
R/00_visualizationHelpers.R#L133   col_levels <- c(pal, colorFallback)    ...
R/00_visualizationHelpers.R#L134    ...
R/00_visualizationHelpers.R#L135   map_nt_to_col_idx <- function(v) { ...
R/00_visualizationHelpers.R#L139   } ...
R/00_visualizationHelpers.R#L140    ...
R/00_visualizationHelpers.R#L141   # Reference row nucleotides ...
R/00_visualizationHelpers.R#L142   ref_nt <- M[ref_row, ] ...
R/00_visualizationHelpers.R#L143    ...
R/00_visualizationHelpers.R#L144   # Collect mismatch positions and color ...
R/00_visualizationHelpers.R#L145   nseq <- nrow(M) ...
R/00_visualizationHelpers.R#L146   diffs_list <- vector("list", nseq) ...
R/00_visualizationHelpers.R#L147   # placeholder (reference row) ...
R/00_visualizationHelpers.R#L148   diffs_list[[ref_row]] <- list(pos = in ...
R/00_visualizationHelpers.R#L149    ...
R/00_visualizationHelpers.R#L150   if (nseq > 1L) { ...
R/00_visualizationHelpers.R#L152       neq <- M[i, ] != ref_nt ...
R/00_visualizationHelpers.R#L153       if (any(neq)) { ...
R/00_visualizationHelpers.R#L157       } else { ...
R/00_visualizationHelpers.R#L159       } ...
R/00_visualizationHelpers.R#L161   } ...
R/00_visualizationHelpers.R#L162    ...
R/00_visualizationHelpers.R#L163   structure( ...
R/00_visualizationHelpers.R#L165       genome_len = genome_len, ...
R/00_visualizationHelpers.R#L166       seq_names  = names_ord, ...
R/00_visualizationHelpers.R#L167       ref_label  = ref_label, ...
R/00_visualizationHelpers.R#L168       ref_row    = ref_row, ...
R/00_visualizationHelpers.R#L169       diffs_list = diffs_list, ...
R/00_visualizationHelpers.R#L170       col_levels = col_levels, ...
R/00_visualizationHelpers.R#L171       colorMap = colorMap, ...
R/00_visualizationHelpers.R#L172       colorFallback = colorFallback ...
R/00_visualizationHelpers.R#L175   ) ...
R/00_visualizationHelpers.R#L202   stopifnot(inherits(cache, "SNPeekCache ...
R/00_visualizationHelpers.R#L203   keep_idx <- sort(unique(keep_idx)) ...
R/00_visualizationHelpers.R#L204   keep_idx <- keep_idx[keep_idx >= 1 & k ...
R/00_visualizationHelpers.R#L205   cache2 <- cache ...
R/00_visualizationHelpers.R#L206   cache2$seq_names  <- cache$seq_names[k ...
R/00_visualizationHelpers.R#L207   cache2$diffs_list <- cache$diffs_list[ ...
R/00_visualizationHelpers.R#L208   # ref_row/meta can stay pointing to or ...
R/00_visualizationHelpers.R#L209   cache2 ...
R/00_visualizationHelpers.R#L263   stopifnot(inherits(cache, "SNPeekCache ...
R/00_visualizationHelpers.R#L264    ...
R/00_visualizationHelpers.R#L265   genome_len <- cache$genome_len ...
R/00_visualizationHelpers.R#L266   if (!is.null(center) && !is.null(windo ...
R/00_visualizationHelpers.R#L269   } ...
R/00_visualizationHelpers.R#L270   if (is.null(xlim)) xlim <- c(1L, genom ...
R/00_visualizationHelpers.R#L271    ...
R/00_visualizationHelpers.R#L272   # Map highlight sequence names to row  ...
R/00_visualizationHelpers.R#L273   hi_idx <- integer(0) ...
R/00_visualizationHelpers.R#L274   if (!is.null(highlight_seqs)) { ...
R/00_visualizationHelpers.R#L277       warning("Some 'highlight_seqs' not ...
R/00_visualizationHelpers.R#L278               paste(highlight_seqs[is.na ...
R/00_visualizationHelpers.R#L279       hi_idx <- hi_idx[!is.na(hi_idx)] ...
R/00_visualizationHelpers.R#L281   } ...
R/00_visualizationHelpers.R#L282    ...
R/00_visualizationHelpers.R#L283   # Optionally reduce to only highlighte ...
R/00_visualizationHelpers.R#L284   if (show_only_highlighted && length(hi ...
R/00_visualizationHelpers.R#L288   } else if (show_only_highlighted && !l ...
R/00_visualizationHelpers.R#L290   } ...
R/00_visualizationHelpers.R#L291    ...
R/00_visualizationHelpers.R#L292   oldPar <- par(mar = c(5, 8, 4, 2) + 0. ...
R/00_visualizationHelpers.R#L293   on.exit(par(oldPar), add = TRUE) ...
R/00_visualizationHelpers.R#L294    ...
R/00_visualizationHelpers.R#L295   plot(NULL, ...
R/00_visualizationHelpers.R#L296        xlim = xlim, ...
R/00_visualizationHelpers.R#L297        ylim = c(0.5, length(cache$seq_na ...
R/00_visualizationHelpers.R#L298        type = "n", ...
R/00_visualizationHelpers.R#L299        xlab = paste0("Genome position of ...
R/00_visualizationHelpers.R#L300        ylab = "", yaxt = "n") ...
R/00_visualizationHelpers.R#L301    ...
R/00_visualizationHelpers.R#L302   axis(2, at = seq_along(cache$seq_names ...
R/00_visualizationHelpers.R#L303    ...
R/00_visualizationHelpers.R#L304   # Soft background bands for highlighte ...
R/00_visualizationHelpers.R#L305   if (length(hi_idx)) { ...
R/00_visualizationHelpers.R#L308       rect(xleft = usr[1], ybottom = i - ...
R/00_visualizationHelpers.R#L309            xright = usr[2], ytop = i + 0 ...
R/00_visualizationHelpers.R#L310            col = highlight_bg, border =  ...
R/00_visualizationHelpers.R#L312   } ...
R/00_visualizationHelpers.R#L313    ...
R/00_visualizationHelpers.R#L314   # Draw diffs, subsetting to xlim first ...
R/00_visualizationHelpers.R#L315   xmin <- xlim[1]; xmax <- xlim[2] ...
R/00_visualizationHelpers.R#L316   for (i in seq_along(cache$diffs_list)) ...
R/00_visualizationHelpers.R#L319       keep <- (d$pos >= xmin) & (d$pos < ...
R/00_visualizationHelpers.R#L320       if (any(keep)) { ...
R/00_visualizationHelpers.R#L325                  x1 = px, y1 = i + seg_h ...
R/00_visualizationHelpers.R#L326                  col = cols, lwd = lw) ...
R/00_visualizationHelpers.R#L327       } ...
R/00_visualizationHelpers.R#L329   } ...
R/00_visualizationHelpers.R#L330    ...
R/00_visualizationHelpers.R#L331   if (showLegend) { ...
R/00_visualizationHelpers.R#L335            legend = leg_labs, ...
R/00_visualizationHelpers.R#L336            fill   = leg_cols, ...
R/00_visualizationHelpers.R#L337            cex = 0.6, bty = "n", box.col ...
R/00_visualizationHelpers.R#L338            bg = "white") ...
R/00_visualizationHelpers.R#L339   } ...
R/00_visualizationHelpers.R#L340    ...
R/00_visualizationHelpers.R#L341   invisible(list( ...
R/00_visualizationHelpers.R#L345   )) ...
R/01_getPrototypeSeqs.R#L59   # Check if folder exists ...
R/01_getPrototypeSeqs.R#L60   if (!dir.exists(destinationFolder))  ...
R/01_getPrototypeSeqs.R#L62    ...
R/01_getPrototypeSeqs.R#L63   # Gets the prototypes ...
R/01_getPrototypeSeqs.R#L64   ref <- system.file("extdata", "prototy ...
R/01_getPrototypeSeqs.R#L65    ...
R/01_getPrototypeSeqs.R#L66   # Copy file to destination ...
R/01_getPrototypeSeqs.R#L67   file.copy(from = ref, ...
R/01_getPrototypeSeqs.R#L70    ...
R/01_getPrototypeSeqs.R#L71   message("The reference sequences have  ...
R/02_alignToRefs.R#L80   # validate input ...
R/02_alignToRefs.R#L81   method <- match.arg(method, c("Clustal ...
R/02_alignToRefs.R#L82    ...
R/02_alignToRefs.R#L83   # get references ...
R/02_alignToRefs.R#L84   ref <- system.file("extdata", "prototy ...
R/02_alignToRefs.R#L85   refseqs <- Biostrings::readDNAStringSe ...
R/02_alignToRefs.R#L86    ...
R/02_alignToRefs.R#L87   # Concatenate with rhinovirus referenc ...
R/02_alignToRefs.R#L88   allseqs <- c(seqData, refseqs) ...
R/02_alignToRefs.R#L89    ...
R/02_alignToRefs.R#L90   # Align with msa ...
R/02_alignToRefs.R#L91   aln <- msa::msa(allseqs, method = meth ...
R/02_alignToRefs.R#L92    ...
R/02_alignToRefs.R#L93   # Convert to Biostrings DNAMultipleAli ...
R/02_alignToRefs.R#L94   aln_bio <- as(aln, "DNAMultipleAlignme ...
R/02_alignToRefs.R#L95   aln_set <- Biostrings::DNAStringSet(al ...
R/02_alignToRefs.R#L96    ...
R/02_alignToRefs.R#L97   # Optionally trim to reference non-gap ...
R/02_alignToRefs.R#L98   if (isTRUE(trimToRef)) { ...
R/02_alignToRefs.R#L100       stop("refName not found in alignme ...
R/02_alignToRefs.R#L101            "'. Available names include e ...
R/02_alignToRefs.R#L102            paste(utils::head(names(aln_s ...
R/02_alignToRefs.R#L105   } ...
R/02_alignToRefs.R#L106    ...
R/02_alignToRefs.R#L107   aln_set ...
R/02_alignToRefs.R#L128   stopifnot(inherits(aln_set, "DNAString ...
R/02_alignToRefs.R#L129   if (!all(Biostrings::width(aln_set) == ...
R/02_alignToRefs.R#L131   if (!ref_name %in% names(aln_set)) ...
R/02_alignToRefs.R#L133    ...
R/02_alignToRefs.R#L134   ref <- aln_set[ref_name] ...
R/02_alignToRefs.R#L135   ref_chars <- strsplit(as.character(ref ...
R/02_alignToRefs.R#L136   non_gap_idx <- which(ref_chars != "-") ...
R/02_alignToRefs.R#L137   if (length(non_gap_idx) == 0) ...
R/02_alignToRefs.R#L139    ...
R/02_alignToRefs.R#L140   start_pos <- non_gap_idx[1] ...
R/02_alignToRefs.R#L141   end_pos   <- non_gap_idx[length(non_ga ...
R/02_alignToRefs.R#L142    ...
R/02_alignToRefs.R#L143   Biostrings::subseq(aln_set, start = st ...
R/03_SNPeek.R#L70                    ref_name = NULL, ...
R/03_SNPeek.R#L71                    xlim = NULL, ...
R/03_SNPeek.R#L72                    center = NULL, window ...
R/03_SNPeek.R#L73                    showLegend = FALSE, ...
R/03_SNPeek.R#L74                    colorMapNT = c(A = "g ...
R/03_SNPeek.R#L75                    colorFallback = "grey ...
R/03_SNPeek.R#L76                    highlight_seqs = NULL ...
R/03_SNPeek.R#L77                    highlight_bg = grDevi ...
R/03_SNPeek.R#L78                    lwd_normal = 1, ...
R/03_SNPeek.R#L79                    lwd_highlight = 2, ...
R/03_SNPeek.R#L80                    seg_half_height = 0.3 ...
R/03_SNPeek.R#L81                    y_cex = 0.8, ...
R/03_SNPeek.R#L82                    line_col = "grey20", ...
R/03_SNPeek.R#L83                    show_only_highlighted ...
R/03_SNPeek.R#L84    ...
R/03_SNPeek.R#L85   # Build cache (compute-once if you wan ...
R/03_SNPeek.R#L86   cache <- compute_cache( ...
R/03_SNPeek.R#L91   ) ...
R/03_SNPeek.R#L92    ...
R/03_SNPeek.R#L93   # If user didn’t specify xlim/center+w ...
R/03_SNPeek.R#L94   # (plot_window will default to full sp ...
R/03_SNPeek.R#L95   plot_window(cache = cache, ...
R/03_SNPeek.R#L96               xlim = xlim, center = cent ...
R/03_SNPeek.R#L97               showLegend = showLegend, ...
R/03_SNPeek.R#L98               highlight_seqs = highlight ...
R/03_SNPeek.R#L99               highlight_bg = highlight_b ...
R/03_SNPeek.R#L100               lwd_normal = lwd_normal, l ...
R/03_SNPeek.R#L101               seg_half_height = seg_half ...
R/03_SNPeek.R#L102               y_cex = y_cex, ...
R/03_SNPeek.R#L103               line_col = line_col, ...
R/03_SNPeek.R#L104               show_only_highlighted = sh ...
R/03_SNPeek.R#L105    ...
R/03_SNPeek.R#L106   invisible(cache) # return cache to reu ...
R/04_countSNPs.R#L28   if (!inherits(fastaData, "DNAStringSet ...
R/04_countSNPs.R#L30   w <- Biostrings::width(fastaData) ...
R/04_countSNPs.R#L31   if (length(unique(w)) != 1L) ...
R/04_countSNPs.R#L33    ...
R/04_countSNPs.R#L34   if (deleteGapsGlobally) { ...
R/04_countSNPs.R#L36   } ...
R/04_countSNPs.R#L37    ...
R/04_countSNPs.R#L38   res <- MSA2dist::dnastring2dist(fastaD ...
R/04_countSNPs.R#L39   D <- as.matrix(res$distSTRING)  # mism ...
R/04_countSNPs.R#L40   N <- as.matrix(res$sitesUsed)   # site ...
R/04_countSNPs.R#L41    ...
R/04_countSNPs.R#L42   # Round to nearest integer with +0.5 t ...
R/04_countSNPs.R#L43   SNP <- matrix(as.integer(D * N + 0.5), ...
R/04_countSNPs.R#L45   SNP ...
R/05_pairwiseDistances.R#L52                               model = "I ...
R/05_pairwiseDistances.R#L53                               deleteGaps ...
R/05_pairwiseDistances.R#L54                               ...) { ...
R/05_pairwiseDistances.R#L55   # checks ...
R/05_pairwiseDistances.R#L56   if (!inherits(fastaData, "DNAStringSet ...
R/05_pairwiseDistances.R#L58   w <- Biostrings::width(fastaData) ...
R/05_pairwiseDistances.R#L59   if (length(unique(w)) != 1L) ...
R/05_pairwiseDistances.R#L61    ...
R/05_pairwiseDistances.R#L62   if (deleteGapsGlobally) { ...
R/05_pairwiseDistances.R#L64   } ...
R/05_pairwiseDistances.R#L65    ...
R/05_pairwiseDistances.R#L66   # Compute pairwise distances ...
R/05_pairwiseDistances.R#L67   res <- MSA2dist::dnastring2dist( ...
R/05_pairwiseDistances.R#L71   ) ...
R/05_pairwiseDistances.R#L72    ...
R/05_pairwiseDistances.R#L73   # Extract the distance matrix ...
R/05_pairwiseDistances.R#L74   distanceMatrix <- as.matrix(res$distST ...
R/05_pairwiseDistances.R#L75    ...
R/05_pairwiseDistances.R#L76   return(distanceMatrix) ...
R/06_assignTypes.R#L77                        model = "IUPAC", ...
R/06_assignTypes.R#L78                        deleteGapsGloball ...
R/06_assignTypes.R#L79                        threshold = 0.105 ...
R/06_assignTypes.R#L80    ...
R/06_assignTypes.R#L81   if (deleteGapsGlobally) { ...
R/06_assignTypes.R#L83   } ...
R/06_assignTypes.R#L84    ...
R/06_assignTypes.R#L85   # Load prototype accessions (expects o ...
R/06_assignTypes.R#L86   ref <- system.file("extdata", "prototy ...
R/06_assignTypes.R#L87   load(ref)  # loads 'prototypes' ...
R/06_assignTypes.R#L88   names_to_keep <- prototypes$Accession ...
R/06_assignTypes.R#L89    ...
R/06_assignTypes.R#L90   # Require prototypes to be present in  ...
R/06_assignTypes.R#L91   if (!all(names_to_keep %in% names(fast ...
R/06_assignTypes.R#L93       "To classify rhinovirus sequences, ...
R/06_assignTypes.R#L94       "sequences (same accessions). You  ...
R/06_assignTypes.R#L95       "  (1) Align in R with packaged re ...
R/06_assignTypes.R#L96       "alignToRefs(seqData = fastaData,  ...
R/06_assignTypes.R#L97       "  (2) Export prototypes with getP ...
R/06_assignTypes.R#L98       "align using your preferred tool,  ...
R/06_assignTypes.R#L100   } ...
R/06_assignTypes.R#L101    ...
R/06_assignTypes.R#L102   # Compute pairwise distances ...
R/06_assignTypes.R#L103   distances <- pairwiseDistances( ...
R/06_assignTypes.R#L107   ) ...
R/06_assignTypes.R#L108    ...
R/06_assignTypes.R#L109   # Keep ONLY prototype columns; remove  ...
R/06_assignTypes.R#L110   distances <- distances[, colnames(dist ...
R/06_assignTypes.R#L111   distances <- distances[!rownames(dista ...
R/06_assignTypes.R#L112    ...
R/06_assignTypes.R#L113   # Assign one query (row) at a time ...
R/06_assignTypes.R#L114   assign_one <- function(row_vals) { ...
R/06_assignTypes.R#L117       return(c("unassigned", NA_characte ...
R/06_assignTypes.R#L123       return(c("unassigned", NA_characte ...
R/06_assignTypes.R#L130       assignedType <- sub(".*_", "", gsu ...
R/06_assignTypes.R#L131       return(c(assignedType, as.characte ...
R/06_assignTypes.R#L133       return(c("unassigned", as.characte ...
R/06_assignTypes.R#L135   } ...
R/06_assignTypes.R#L136    ...
R/06_assignTypes.R#L137   # Apply over all queries ...
R/06_assignTypes.R#L138   result <- t(apply(distances, 1, assign ...
R/06_assignTypes.R#L139    ...
R/06_assignTypes.R#L140   # Assemble output ...
R/06_assignTypes.R#L141   outputDf <- data.frame( ...
R/06_assignTypes.R#L147   ) ...
R/06_assignTypes.R#L148    ...
R/06_assignTypes.R#L149   return(outputDf) ...
R/07_overallMeanDistance.R#L38    ...
R/07_overallMeanDistance.R#L39   if (deleteGapsGlobally) { ...
R/07_overallMeanDistance.R#L41   } ...
R/07_overallMeanDistance.R#L42    ...
R/07_overallMeanDistance.R#L43   # Compute pairwise distances ...
R/07_overallMeanDistance.R#L44   res <- MSA2dist::dnastring2dist( ...
R/07_overallMeanDistance.R#L48   ) ...
R/07_overallMeanDistance.R#L49    ...
R/07_overallMeanDistance.R#L50   # Extract the distance matrix ...
R/07_overallMeanDistance.R#L51   distanceMatrix <- as.matrix(res$distST ...
R/07_overallMeanDistance.R#L52    ...
R/07_overallMeanDistance.R#L53   # Overall mean pairwise distance (excl ...
R/07_overallMeanDistance.R#L54   meanDist <- mean(distanceMatrix[lower. ...
R/07_overallMeanDistance.R#L55    ...
R/07_overallMeanDistance.R#L56   return(meanDist) ...
R/08_plotFrequency.R#L44                           showLegend = F ...
R/08_plotFrequency.R#L45                           sort = FALSE, ...
R/08_plotFrequency.R#L46                           las = 2, ...
R/08_plotFrequency.R#L47                           cex_names = 0. ...
R/08_plotFrequency.R#L48   # basic checks ...
R/08_plotFrequency.R#L49   if (!is.data.frame(assignedTypesDF)) { ...
R/08_plotFrequency.R#L51   } ...
R/08_plotFrequency.R#L52   req <- c("query", "assignedType") ...
R/08_plotFrequency.R#L53   missing_cols <- setdiff(req, names(ass ...
R/08_plotFrequency.R#L54   if (length(missing_cols)) { ...
R/08_plotFrequency.R#L56   } ...
R/08_plotFrequency.R#L57    ...
R/08_plotFrequency.R#L58   # normalize assignedType ...
R/08_plotFrequency.R#L59   atype <- as.character(assignedTypesDF$ ...
R/08_plotFrequency.R#L60   if (length(atype) == 0L) stop("No rows ...
R/08_plotFrequency.R#L61    ...
R/08_plotFrequency.R#L62   # count per assigned type ...
R/08_plotFrequency.R#L63   types_counts <- as.data.frame(table(as ...
R/08_plotFrequency.R#L64   names(types_counts) <- c("assignedType ...
R/08_plotFrequency.R#L65    ...
R/08_plotFrequency.R#L66   # species mapping helper: ...
R/08_plotFrequency.R#L67   # strip common prefixes (RV-, RV_, RV) ...
R/08_plotFrequency.R#L68   norm_first_letter <- function(x) { ...
R/08_plotFrequency.R#L70            "Other", ...
R/08_plotFrequency.R#L71            { ...
R/08_plotFrequency.R#L72              # remove RV prefix variants ...
R/08_plotFrequency.R#L73              x2 <- gsub("^(RV[-_ ]?|RV)" ...
R/08_plotFrequency.R#L74              fl <- toupper(substr(x2, 1, ...
R/08_plotFrequency.R#L75              ifelse(fl %in% c("A","B","C ...
R/08_plotFrequency.R#L76            }) ...
R/08_plotFrequency.R#L77   } ...
R/08_plotFrequency.R#L78    ...
R/08_plotFrequency.R#L79   types_counts$species <- vapply(types_c ...
R/08_plotFrequency.R#L80    ...
R/08_plotFrequency.R#L81   # colors ...
R/08_plotFrequency.R#L82   color_map <- c(A = "blue", B = "red",  ...
R/08_plotFrequency.R#L83   bar_cols <- unname(color_map[types_cou ...
R/08_plotFrequency.R#L84    ...
R/08_plotFrequency.R#L85   # optional sorting ...
R/08_plotFrequency.R#L86   if (isTRUE(sort)) { ...
R/08_plotFrequency.R#L90   } ...
R/08_plotFrequency.R#L91    ...
R/08_plotFrequency.R#L92   # plot ...
R/08_plotFrequency.R#L93   bp <- barplot( ...
R/08_plotFrequency.R#L102   ) ...
R/08_plotFrequency.R#L103    ...
R/08_plotFrequency.R#L104   if (isTRUE(showLegend)) { ...
R/08_plotFrequency.R#L106            legend = names(color_map), ...
R/08_plotFrequency.R#L107            fill   = unname(color_map), ...
R/08_plotFrequency.R#L108            title  = "Species", ...
R/08_plotFrequency.R#L109            bty    = "n", ...
R/08_plotFrequency.R#L110            inset  = 0.02, ...
R/08_plotFrequency.R#L111            horiz  = FALSE) ...
R/08_plotFrequency.R#L112   } ...
R/08_plotFrequency.R#L113    ...
R/08_plotFrequency.R#L114   invisible(types_counts) ...
R/09_plotDistances.R#L39   # Convert the data to a matrix  ...
R/09_plotDistances.R#L40   distancesMatrix <- as.matrix(distances ...
R/09_plotDistances.R#L41    ...
R/09_plotDistances.R#L42   # Heatmap ...
R/09_plotDistances.R#L43   myplot <- stats::heatmap( ...
R/09_plotDistances.R#L50   ) ...
R/09_plotDistances.R#L51    ...
R/09_plotDistances.R#L52   invisible(myplot) ...
R/10_plotTree.R#L35   # coerce and validate ...
R/10_plotTree.R#L36   distance_matrix <- as.matrix(distance_ ...
R/10_plotTree.R#L37   if (!is.numeric(distance_matrix)) { ...
R/10_plotTree.R#L39   } ...
R/10_plotTree.R#L40   if (nrow(distance_matrix) != ncol(dist ...
R/10_plotTree.R#L42   } ...
R/10_plotTree.R#L43   # require symmetry (tolerance to small ...
R/10_plotTree.R#L44   if (!isTRUE(all.equal(distance_matrix, ...
R/10_plotTree.R#L46   } ...
R/10_plotTree.R#L47   # diagonal should be 0 ...
R/10_plotTree.R#L48   if (any(diag(distance_matrix) != 0, na ...
R/10_plotTree.R#L50   } ...
R/10_plotTree.R#L51   # no NAs ...
R/10_plotTree.R#L52   if (anyNA(distance_matrix)) { ...
R/10_plotTree.R#L54   } ...
R/10_plotTree.R#L55    ...
R/10_plotTree.R#L56   # build and plot ...
R/10_plotTree.R#L57   d <- stats::as.dist(distance_matrix) ...
R/10_plotTree.R#L58   hc <- stats::hclust(d, method = "compl ...
R/10_plotTree.R#L59   plot(hc, ...)  # stats::plot.hclust is ...
R/10_plotTree.R#L60   invisible(hc) ...
R/11_plotAA.R#L89                    ref_name = NULL, ...
R/11_plotAA.R#L90                    xlim = NULL, ...
R/11_plotAA.R#L91                    center = NULL, window ...
R/11_plotAA.R#L92                    showLegend = FALSE, ...
R/11_plotAA.R#L93                    # 4-group AA color ma ...
R/11_plotAA.R#L94                    colorMapAA = c( ...
R/11_plotAA.R#L95                      R = "red2", H = "re ...
R/11_plotAA.R#L96                      D = "blue2", E = "b ...
R/11_plotAA.R#L97                      S = "green3", T = " ...
R/11_plotAA.R#L98                      A = "gold", V = "go ...
R/11_plotAA.R#L99                      F = "gold", W = "go ...
R/11_plotAA.R#L100                    ), ...
R/11_plotAA.R#L101                    colorFallback = "grey ...
R/11_plotAA.R#L102                    highlight_seqs = NULL ...
R/11_plotAA.R#L103                    highlight_bg = grDevi ...
R/11_plotAA.R#L104                    lwd_normal = 1, ...
R/11_plotAA.R#L105                    lwd_highlight = 2, ...
R/11_plotAA.R#L106                    seg_half_height = 0.3 ...
R/11_plotAA.R#L107                    y_cex = 0.8, ...
R/11_plotAA.R#L108                    line_col = "grey20", ...
R/11_plotAA.R#L109                    show_only_highlighted ...
R/11_plotAA.R#L110    ...
R/11_plotAA.R#L111   # Build an AA cache using the same eng ...
R/11_plotAA.R#L112   cache <- compute_cache( ...
R/11_plotAA.R#L117   ) ...
R/11_plotAA.R#L118    ...
R/11_plotAA.R#L119   # Draw (full span if no xlim/center+wi ...
R/11_plotAA.R#L120   plot_window( ...
R/11_plotAA.R#L133   ) ...
R/11_plotAA.R#L134   invisible(cache) ...
vignettes/rhinotypeR.Rmd#L88   system.file("extdata", "input_aln.fast ...
vignettes/rhinotypeR.Rmd#L100   seqData   = rhinovirusVP4, ...
vignettes/rhinotypeR.Rmd#L101   method    = "ClustalW",           # or ...
vignettes/rhinotypeR.Rmd#L102   trimToRef = TRUE,                 # cr ...
vignettes/rhinotypeR.Rmd#L103   refName   = "JN855971.1_A107"     # de ...
vignettes/rhinotypeR.Rmd#L151   fastaData = rhinovirusVP4, ...
vignettes/rhinotypeR.Rmd#L152   model = "IUPAC", ...
vignettes/rhinotypeR.Rmd#L153   deleteGapsGlobally = FALSE   # set TRU ...
vignettes/rhinotypeR.Rmd#L176          main = "A simple tree", xlab =  ...
vignettes/rhinotypeR.Rmd#L187    ...
vignettes/rhinotypeR.Rmd#L205   gsub("-", "", as.character(rhinovirusV ...
Checking if package already exists in CRAN... OK
Checking for bioc-devel mailing list subscription...
Cannot determine whether maintainer is subscribed to the Bioc-Devel mailing list (requires admin credentials). Subscribe here: https://stat.ethz.ch/mailman/listinfo/bioc-devel
Checking for support site registration... OK
